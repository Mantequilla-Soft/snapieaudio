<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Developer Documentation - SnapieAudioPlayer</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f5f5f5;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 40px 20px;
      text-align: center;
    }

    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .sidebar {
      position: sticky;
      top: 20px;
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }

    .sidebar h3 {
      color: #667eea;
      margin-bottom: 15px;
    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar li {
      padding: 8px 0;
    }

    .sidebar a {
      color: #333;
      text-decoration: none;
      transition: color 0.3s;
    }

    .sidebar a:hover {
      color: #667eea;
    }

    .content {
      background: white;
      border-radius: 8px;
      padding: 40px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    h2 {
      color: #667eea;
      margin: 40px 0 20px 0;
      padding-bottom: 10px;
      border-bottom: 2px solid #f0f0f0;
    }

    h2:first-child {
      margin-top: 0;
    }

    h3 {
      color: #764ba2;
      margin: 30px 0 15px 0;
    }

    code {
      background: #f4f4f4;
      padding: 3px 6px;
      border-radius: 4px;
      font-family: 'Courier New', Courier, monospace;
      font-size: 0.9em;
    }

    pre {
      background: #2d2d2d;
      color: #f8f8f2;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      margin: 20px 0;
      line-height: 1.4;
    }

    pre code {
      background: none;
      padding: 0;
      color: inherit;
    }

    .endpoint {
      background: #f0f4ff;
      border-left: 4px solid #667eea;
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .method {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-weight: 600;
      font-size: 0.85em;
      margin-right: 10px;
    }

    .method-get { background: #28a745; color: white; }
    .method-post { background: #007bff; color: white; }
    .method-delete { background: #dc3545; color: white; }

    .note {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .warning {
      background: #f8d7da;
      border-left: 4px solid #dc3545;
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .success {
      background: #d4edda;
      border-left: 4px solid #28a745;
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 4px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    th {
      background: #f9f9f9;
      font-weight: 600;
    }

    .back-link {
      display: inline-block;
      margin-top: 40px;
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
    }

    .back-link:hover {
      text-decoration: underline;
    }

    @media (min-width: 768px) {
      .container {
        display: grid;
        grid-template-columns: 250px 1fr;
        gap: 30px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üìö Developer Documentation</h1>
    <p>Complete guide to integrating SnapieAudioPlayer</p>
  </div>

  <div class="container">
    <aside class="sidebar">
      <h3>Contents</h3>
      <ul>
        <li><a href="#getting-started">Getting Started</a></li>
        <li><a href="#authentication">Authentication</a></li>
        <li><a href="#embedding">Embedding Player</a></li>
        <li><a href="#upload-api">Upload API</a></li>
        <li><a href="#playback-api">Playback API</a></li>
        <li><a href="#examples">Code Examples</a></li>
        <li><a href="#rate-limits">Rate Limits</a></li>
        <li><a href="#errors">Error Handling</a></li>
      </ul>
    </aside>

    <main class="content">
      <h2 id="getting-started">üöÄ Getting Started</h2>
      <p>SnapieAudioPlayer provides a REST API for uploading, storing, and playing audio files on the decentralized IPFS network. All audio files are stored permanently on IPFS and metadata is indexed in our MongoDB database for fast retrieval.</p>

      <div class="success">
        <strong>‚úì Base URL:</strong> <code>https://audio.3speak.tv</code>
      </div>

      <h3>Quick Start</h3>
      <ol>
        <li>Get an API key (contact 3speak team)</li>
        <li>Upload audio via REST API</li>
        <li>Embed player using returned permlink or CID</li>
        <li>Track plays and engagement</li>
      </ol>

      <h2 id="authentication">üîê Authentication</h2>
      <p>API keys are required for uploading audio. Include your API key in the request header:</p>

      <pre><code>X-API-Key: sk_your_api_key_here</code></pre>

      <div class="note">
        <strong>Note:</strong> Reading audio metadata and playback do not require authentication. Only uploads are protected.
      </div>

      <h2 id="embedding">üì∫ Embedding Player</h2>
      
      <h3>Using iFrame</h3>
      <pre><code>&lt;!-- Embed by permlink --&gt;
&lt;iframe 
  src="https://audio.3speak.tv/play?a=abc123xyz"
  width="100%" 
  height="120"
  frameborder="0"
  allow="autoplay"&gt;
&lt;/iframe&gt;

&lt;!-- Embed by IPFS CID --&gt;
&lt;iframe 
  src="https://audio.3speak.tv/play?cid=QmdMsEXyDe5Z4S3n8THfYgFP1iH3ngCeCytdHnndzqdZAK"
  width="100%" 
  height="120"
  frameborder="0"&gt;
&lt;/iframe&gt;</code></pre>

      <h3>Display Modes</h3>
      <table>
        <thead>
          <tr>
            <th>Mode</th>
            <th>Height</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>minimal</code></td>
            <td>80px</td>
            <td>Play button, waveform, time only</td>
          </tr>
          <tr>
            <td><code>compact</code></td>
            <td>120px</td>
            <td>Default - full controls without metadata</td>
          </tr>
          <tr>
            <td><code>full</code></td>
            <td>180px</td>
            <td>All controls + title, owner, plays</td>
          </tr>
        </tbody>
      </table>

      <pre><code>&lt;iframe src="https://audio.3speak.tv/play?a=abc123&amp;mode=minimal" height="80"&gt;&lt;/iframe&gt;</code></pre>

      <h2 id="upload-api">üì§ Upload API</h2>

      <div class="endpoint">
        <span class="method method-post">POST</span>
        <code>/api/audio/upload</code>
      </div>

      <p>Upload audio files to IPFS with metadata indexing.</p>

      <h3>Headers</h3>
      <table>
        <thead>
          <tr>
            <th>Header</th>
            <th>Required</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>X-API-Key</code></td>
            <td>Yes</td>
            <td>Your API key</td>
          </tr>
          <tr>
            <td><code>X-User</code></td>
            <td>No</td>
            <td>Username (defaults to "anonymous")</td>
          </tr>
          <tr>
            <td><code>Content-Type</code></td>
            <td>Yes</td>
            <td><code>multipart/form-data</code></td>
          </tr>
        </tbody>
      </table>

      <h3>Form Data Parameters</h3>
      <table>
        <thead>
          <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Required</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>audio</code></td>
            <td>File</td>
            <td>Yes</td>
            <td>Audio file (mp3, m4a, ogg, webm, wav)</td>
          </tr>
          <tr>
            <td><code>duration</code></td>
            <td>Number</td>
            <td>Yes</td>
            <td>Duration in seconds</td>
          </tr>
          <tr>
            <td><code>format</code></td>
            <td>String</td>
            <td>Yes</td>
            <td>File format (mp3, m4a, etc.)</td>
          </tr>
          <tr>
            <td><code>title</code></td>
            <td>String</td>
            <td>No</td>
            <td>Audio title</td>
          </tr>
          <tr>
            <td><code>description</code></td>
            <td>String</td>
            <td>No</td>
            <td>Audio description</td>
          </tr>
          <tr>
            <td><code>codec</code></td>
            <td>String</td>
            <td>No</td>
            <td>Audio codec (aac, mp3, etc.)</td>
          </tr>
          <tr>
            <td><code>bitrate</code></td>
            <td>Number</td>
            <td>No</td>
            <td>Bitrate in kbps</td>
          </tr>
          <tr>
            <td><code>sampleRate</code></td>
            <td>Number</td>
            <td>No</td>
            <td>Sample rate in Hz</td>
          </tr>
          <tr>
            <td><code>channels</code></td>
            <td>Number</td>
            <td>No</td>
            <td>Number of channels (1=mono, 2=stereo)</td>
          </tr>
          <tr>
            <td><code>waveform</code></td>
            <td>JSON</td>
            <td>No</td>
            <td>Waveform data object</td>
          </tr>
        </tbody>
      </table>

      <div class="warning">
        <strong>‚ö†Ô∏è File Limits:</strong>
        <ul style="margin-top: 10px;">
          <li>Max file size: <strong>50MB</strong></li>
          <li>Supported formats: mp3, m4a, ogg, webm, wav</li>
          <li>Rate limit: 10 uploads per minute</li>
        </ul>
      </div>

      <h3>Response</h3>
      <pre><code>{
  "success": true,
  "permlink": "w2ehm8pr",
  "cid": "QmdMsEXyDe5Z4S3n8THfYgFP1iH3ngCeCytdHnndzqdZAK",
  "playUrl": "https://audio.3speak.tv/play?a=w2ehm8pr",
  "apiUrl": "https://audio.3speak.tv/api/audio?a=w2ehm8pr"
}</code></pre>

      <h2 id="playback-api">‚ñ∂Ô∏è Playback API</h2>

      <div class="endpoint">
        <span class="method method-get">GET</span>
        <code>/api/audio</code>
      </div>

      <p>Retrieve audio metadata for playback. No authentication required.</p>

      <h3>Query Parameters</h3>
      <table>
        <thead>
          <tr>
            <th>Parameter</th>
            <th>Description</th>
            <th>Example</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>a</code></td>
            <td>Audio permlink</td>
            <td><code>?a=w2ehm8pr</code></td>
          </tr>
          <tr>
            <td><code>cid</code></td>
            <td>IPFS Content ID</td>
            <td><code>?cid=QmdMsEX...</code></td>
          </tr>
        </tbody>
      </table>

      <h3>Response</h3>
      <pre><code>{
  "permlink": "w2ehm8pr",
  "owner": "meno",
  "audio_cid": "QmdMsEXyDe5Z4S3n8THfYgFP1iH3ngCeCytdHnndzqdZAK",
  "duration": 45,
  "format": "mp3",
  "bitrate": 128,
  "sampleRate": 44100,
  "channels": 1,
  "waveform": {
    "peaks": [0.05, 0.34, 0.93, ...],
    "samples": 100
  },
  "audioUrl": "http://gateway.ipfs/ipfs/QmdMsEX...",
  "audioUrlFallback": "https://ipfs.io/ipfs/QmdMsEX...",
  "title": "My Audio",
  "plays": 42,
  "likes": 5,
  "createdAt": "2025-11-27T01:22:17.053Z"
}</code></pre>

      <h3>Track Play Count</h3>

      <div class="endpoint">
        <span class="method method-post">POST</span>
        <code>/api/audio/play</code>
      </div>

      <p>Increment play counter when audio starts playing.</p>

      <pre><code>POST /api/audio/play
Content-Type: application/json

{
  "permlink": "w2ehm8pr"
}

Response:
{
  "success": true,
  "plays": 43
}</code></pre>

      <h2 id="examples">üíª Code Examples</h2>

      <h3>JavaScript (Fetch API)</h3>
      <pre><code>// Upload audio file
async function uploadAudio(file) {
  const formData = new FormData();
  formData.append('audio', file);
  formData.append('duration', 45);
  formData.append('format', 'mp3');
  formData.append('title', 'My Recording');

  const response = await fetch('https://audio.3speak.tv/api/audio/upload', {
    method: 'POST',
    headers: {
      'X-API-Key': 'sk_your_api_key',
      'X-User': 'username'
    },
    body: formData
  });

  return await response.json();
}

// Get audio metadata
async function getAudio(permlink) {
  const response = await fetch(
    `https://audio.3speak.tv/api/audio?a=${permlink}`
  );
  return await response.json();
}

// Track play
async function trackPlay(permlink) {
  await fetch('https://audio.3speak.tv/api/audio/play', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ permlink })
  });
}</code></pre>

      <h3>cURL</h3>
      <pre><code># Upload audio
curl -X POST https://audio.3speak.tv/api/audio/upload \
  -H "X-API-Key: sk_your_api_key" \
  -H "X-User: username" \
  -F "audio=@recording.mp3" \
  -F "duration=45" \
  -F "format=mp3" \
  -F "title=My Recording"

# Get metadata
curl "https://audio.3speak.tv/api/audio?a=w2ehm8pr"

# Track play
curl -X POST https://audio.3speak.tv/api/audio/play \
  -H "Content-Type: application/json" \
  -d '{"permlink":"w2ehm8pr"}'</code></pre>

      <h3>Python</h3>
      <pre><code>import requests

# Upload audio
def upload_audio(file_path, api_key):
    with open(file_path, 'rb') as f:
        files = {'audio': f}
        data = {
            'duration': 45,
            'format': 'mp3',
            'title': 'My Recording'
        }
        headers = {
            'X-API-Key': api_key,
            'X-User': 'username'
        }
        
        response = requests.post(
            'https://audio.3speak.tv/api/audio/upload',
            files=files,
            data=data,
            headers=headers
        )
        return response.json()

# Get metadata
def get_audio(permlink):
    response = requests.get(
        f'https://audio.3speak.tv/api/audio?a={permlink}'
    )
    return response.json()</code></pre>

      <h2 id="rate-limits">‚è±Ô∏è Rate Limits</h2>

      <table>
        <thead>
          <tr>
            <th>Endpoint</th>
            <th>Limit</th>
            <th>Window</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Upload <code>/api/audio/upload</code></td>
            <td>10 requests</td>
            <td>1 minute</td>
          </tr>
          <tr>
            <td>Play tracking <code>/api/audio/play</code></td>
            <td>100 requests</td>
            <td>1 minute</td>
          </tr>
          <tr>
            <td>Metadata <code>/api/audio</code></td>
            <td>Unlimited</td>
            <td>-</td>
          </tr>
        </tbody>
      </table>

      <div class="note">
        <strong>Rate Limit Headers:</strong>
        <ul style="margin-top: 10px;">
          <li><code>X-RateLimit-Limit</code> - Max requests allowed</li>
          <li><code>X-RateLimit-Remaining</code> - Remaining requests</li>
          <li><code>X-RateLimit-Reset</code> - Time when limit resets (Unix timestamp)</li>
        </ul>
      </div>

      <h2 id="errors">‚ùå Error Handling</h2>

      <h3>HTTP Status Codes</h3>
      <table>
        <thead>
          <tr>
            <th>Code</th>
            <th>Meaning</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>200</code></td>
            <td>OK</td>
            <td>Request successful</td>
          </tr>
          <tr>
            <td><code>201</code></td>
            <td>Created</td>
            <td>Upload successful</td>
          </tr>
          <tr>
            <td><code>400</code></td>
            <td>Bad Request</td>
            <td>Invalid parameters or file format</td>
          </tr>
          <tr>
            <td><code>401</code></td>
            <td>Unauthorized</td>
            <td>Missing or invalid API key</td>
          </tr>
          <tr>
            <td><code>404</code></td>
            <td>Not Found</td>
            <td>Audio not found</td>
          </tr>
          <tr>
            <td><code>429</code></td>
            <td>Too Many Requests</td>
            <td>Rate limit exceeded</td>
          </tr>
          <tr>
            <td><code>500</code></td>
            <td>Internal Server Error</td>
            <td>Server error</td>
          </tr>
        </tbody>
      </table>

      <h3>Error Response Format</h3>
      <pre><code>{
  "error": "Invalid file format",
  "message": "Allowed formats: mp3, m4a, ogg, webm, wav"
}</code></pre>

      <h3>Common Errors</h3>

      <div class="warning">
        <strong>Invalid API Key</strong>
        <pre style="margin-top: 10px;"><code>{
  "error": "Invalid API key",
  "message": "The provided API key is not valid"
}</code></pre>
      </div>

      <div class="warning">
        <strong>File Too Large</strong>
        <pre style="margin-top: 10px;"><code>{
  "error": "File too large",
  "message": "Maximum file size is 50MB"
}</code></pre>
      </div>

      <div class="warning">
        <strong>Rate Limit Exceeded</strong>
        <pre style="margin-top: 10px;"><code>{
  "error": "Too many requests, please try again later"
}</code></pre>
      </div>

      <a href="/" class="back-link">‚Üê Back to Home</a>
    </main>
  </div>
</body>
</html>
